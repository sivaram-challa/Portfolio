<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Owner Dashboard - Sivaram Challa</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
    <link rel="stylesheet" href="ownerpsge_style.css">
    <style>
        /* Quill editor styling to match dark theme */
        .ql-toolbar.ql-snow {
            border: 1px solid #30363d !important;
            border-bottom: none !important;
            border-top-left-radius: 0.5rem;
            border-top-right-radius: 0.5rem;
            background-color: #1f242d;
        }
        .ql-container.ql-snow {
            border: 1px solid #30363d !important;
            border-bottom-left-radius: 0.5rem;
            border-bottom-right-radius: 0.5rem;
            background-color: #0d1117;
            color: #c9d1d9;
            min-height: 200px; /* Increased height for content editor */
        }
        .ql-container.ql-snow a {
            color: #58a6ff;
        }
        .ql-editor {
            font-size: 1rem;
        }
        .ql-editor::before {
            color: #8b949e !important;
        }
    </style>
</head>

<body>

    <div id="login-form" class="container text-center">
        <h1 class="text-3xl font-bold text-white mb-4">Owner Login</h1>
        <input type="password" id="password-input" placeholder="Enter your secret password">
        <button onclick="login()">Login</button>
    </div>

    <div id="owner-dashboard" class="hidden container">
        <h1 class="text-4xl font-bold text-white mb-8 text-center">Owner Dashboard</h1>

        <div id="add-blog-post-section" class="card">
        <h2 class="text-2xl font-semibold text-white mb-4">Add New Blog Post</h2>
        <input type="text" id="blog-title" placeholder="Blog Post Title">
        <input type="date" id="blog-date-input" placeholder="Select Date">
        <div id="blog-summary-editor" class="mb-4"></div>
        <div id="blog-content-editor" class="mb-4"></div>
        <button onclick="addBlogPost()">Add Blog Post</button>
    </div>

    <div id="add-project-section" class="card">
        <h2 class="text-2xl font-semibold text-white mb-4">Add New Project</h2>
        <input type="text" id="project-title" placeholder="Project Title">
        <div id="project-description-editor" class="mb-4"></div>
        <input type="text" id="project-image" placeholder="Image URL">
        <input type="text" id="project-source-url" placeholder="Source Code URL">
        <button onclick="addProject()">Add Project</button>
    </div>

        <div id="content-list-section" class="card">
            <h2 class="text-2xl font-semibold text-white mb-4">Current Content</h2>
            
            <h3 class="text-xl font-semibold text-white mb-2">Projects</h3>
            <div id="projects-list"></div>

            <h3 class="text-xl font-semibold text-white mt-8 mb-2">Blog Posts</h3>
            <div id="blog-posts-list"></div>
        </div>

        <div id="output-section" class="card">
            <h2 class="text-2xl font-semibold text-white mb-4">Copy & Paste to `portfolio.html`</h2>
            <p class="text-[#8b949e]">Copy the updated arrays below and paste them into your `portfolio.html` file to update your live site.</p>
            <div id="output-box" class="text-area-copy"></div>
            <button onclick="copyToClipboard()">Copy to Clipboard</button>
        </div>
    </div>

    <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
    <script>
        let blogPostsData = [
            
        ];

        let projectsData = [
            
        ];

        const SECRET_PASSWORD = "RameshMadhaviChetanaSivaram";

        // Initialize Quill editors
        const blogSummaryQuill = new Quill('#blog-summary-editor', {
            theme: 'snow',
            placeholder: 'Blog Post Summary (short preview)',
            modules: {
                toolbar: [
                    [{ 'list': 'bullet' }, { 'list': 'ordered' },{ 'align': ['justify', 'center', 'right'] }],
                    ['bold', 'italic', 'underline']
                ]
            }
        });

        const blogContentQuill = new Quill('#blog-content-editor', {
            theme: 'snow',
            placeholder: 'Full Blog Post Content',
            modules: {
                toolbar: [
                    [{ 'header': [1, 2, 3, 4, 5, 6, false] }],
                    ['bold', 'italic', 'underline', 'strike'],
                    [{ 'list': 'ordered'}, { 'list': 'bullet' }],
                    [{ 'color': [] }, { 'background': [] },{ 'align': ['justify', 'center', 'right'] }],
                    ['link', 'blockquote'],
                    ['clean']
                ]
            }
        });

        const projectDescriptionQuill = new Quill('#project-description-editor', {
            theme: 'snow',
            placeholder: 'Project Description',
            modules: {
                toolbar: [
                    [{ 'header': [1, 2, 3, 4, 5, 6, false] }],
                    ['bold', 'italic', 'underline', 'strike'],
                    [{ 'list': 'ordered'}, { 'list': 'bullet' }],
                    [{ 'color': [] }, { 'background': [] },{ 'align': ['justify', 'center', 'right'] }],
                    ['link', 'blockquote'],
                    ['clean']
                ]
            }
        });

        function login() {
            const password = document.getElementById('password-input').value;
            if (password === SECRET_PASSWORD) {
                document.getElementById('login-form').classList.add('hidden');
                document.getElementById('owner-dashboard').classList.remove('hidden');
                renderContent();
            } else {
                alert("Incorrect password.");
            }
        }

        function renderContent() {
            const projectsList = document.getElementById('projects-list');
            projectsList.innerHTML = '';
            projectsData.forEach((project, index) => {
                const projectDiv = document.createElement('div');
                projectDiv.className = 'flex justify-between items-center bg-[#1f242d] p-4 rounded-md mb-2';
                projectDiv.innerHTML = `
                    <p class="text-white">${project.title}</p>
                    <button class="delete-btn py-1 px-3" onclick="deleteProject(${index})">Delete</button>
                `;
                projectsList.appendChild(projectDiv);
            });

            const blogPostsList = document.getElementById('blog-posts-list');
            blogPostsList.innerHTML = '';
            blogPostsData.forEach((post, index) => {
                const postDiv = document.createElement('div');
                postDiv.className = 'flex justify-between items-center bg-[#1f242d] p-4 rounded-md mb-2';
                postDiv.innerHTML = `
                    <p class="text-white">${post.title}</p>
                    <button class="delete-btn py-1 px-3" onclick="deleteBlogPost(${index})">Delete</button>
                `;
                blogPostsList.appendChild(postDiv);
            });

            updateOutput();
        }

        function addBlogPost() {
            const title = document.getElementById('blog-title').value;
            const date = document.getElementById('blog-date-input').value;
            const summary = blogSummaryQuill.root.innerHTML;
            const content = blogContentQuill.root.innerHTML;

            const dateObj = new Date(date);
            const options = { year: 'numeric', month: 'long', day: 'numeric' };
            const formattedDate = dateObj.toLocaleDateString('en-US', options);

            const id = title.toLowerCase().replace(/[^a-z0-9]+/g, '-').replace(/^-+|-+$/g, '');
            const url = `blogpostcre.html?id=${id}`;

            if (title && date && summary && content) {
                blogPostsData.unshift({ id, title, date: formattedDate, summary, content, url });
                clearForm('blog');
                renderContent();
            } else {
                alert("Please fill all blog post fields.");
            }
        }

        function deleteBlogPost(index) {
            if (confirm("Are you sure you want to delete this blog post?")) {
                blogPostsData.splice(index, 1);
                renderContent();
            }
        }

        function addProject() {
            const title = document.getElementById('project-title').value;
            const description = projectDescriptionQuill.root.innerHTML;
            const image = document.getElementById('project-image').value;
            const sourceCodeUrl = document.getElementById('project-source-url').value;

            if (title && description && image && sourceCodeUrl) {
                projectsData.unshift({ title, description, image, sourceCodeUrl });
                clearForm('project');
                renderContent();
            } else {
                alert("Please fill all project fields.");
            }
        }

        function deleteProject(index) {
            if (confirm("Are you sure you want to delete this project?")) {
                projectsData.splice(index, 1);
                renderContent();
            }
        }

        function clearForm(type) {
            if (type === 'blog') {
                document.getElementById('blog-title').value = '';
                document.getElementById('blog-date-input').value = '';
                blogSummaryQuill.root.innerHTML = '';
                blogContentQuill.root.innerHTML = '';
            } else if (type === 'project') {
                document.getElementById('project-title').value = '';
                projectDescriptionQuill.root.innerHTML = '';
                document.getElementById('project-image').value = '';
                document.getElementById('project-source-url').value = '';
            }
        }

        function updateOutput() {
            const outputBox = document.getElementById('output-box');
            const projectsString = JSON.stringify(projectsData, null, 4);
            const blogPostsString = JSON.stringify(blogPostsData, null, 4);
            
            localStorage.setItem('blogPostsData', blogPostsString);

            outputBox.textContent = `
// --- Copy this section and paste into your portfolio.html file ---
const projectsData = ${projectsString};
            
const blogPostsData = ${blogPostsString};

// -----------------------------------------------------------------
            `;
        }
        
        function copyToClipboard() {
            const outputBox = document.getElementById('output-box');
            const textToCopy = outputBox.textContent;
            navigator.clipboard.writeText(textToCopy).then(() => {
                alert("Content copied to clipboard!");
            }).catch(err => {
                console.error('Failed to copy text: ', err);
            });
        }
    </script>
</body>
</html>